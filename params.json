{"name":"Comandos no RStudio","tagline":"Lista de comandos utilizados para construção do mapa genético de ligação","body":"install.packages(\"onemap\")\r\nlibrary (onemap)\r\nDados_mimulus <-read.mapmaker(dir=\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\", file=\"m_feb06.raw\")\r\nsummary(Dados_mimulus)\r\nunique(Dados_mimulus$segr.type)\r\n\r\ngenotipos<-(Dados_mimulus$geno.mmk)$geno\r\n\r\nPadrao_c8<-which(Dados_mimulus$segr.type==\"C.8\")\r\nPadrao_b37<-which(Dados_mimulus$segr.type==\"B3.7\")\r\n\r\nC8.genotip<-matrix(c(NA),nrow=nrow(genotipos),ncol=length(Padrao_c8))\r\nB3.genotip<-matrix(c(NA),nrow=nrow(genotipos),ncol=length(Padrao_b37))\r\n\r\nfor (i in 1:length(Padrao_c8)){\r\n  C8.genotip[,i]<-genotipos[,Padrao_c8[i]]  \r\n}\r\nfor (i in 1:length(Padrao_b37)){\r\n  B3.genotip[,i]<-genotipos[,Padrao_b37[i]]\r\n}\r\n\r\nqui.quadrado<-function(x,cross=\"\"){  \r\n    \r\n  if(cross==\"f2d\")\r\n    return(chisq.test(table(x),p=c(1/4,3/4))$p.value) \r\n  \r\n  else if(cross==\"f2c\")\r\n    return(chisq.test(table(x),p=c(1/4,1/2,1/4))$p.value)\r\n  \r\n  else stop(\"Tipo de cruzamento inválido\")\r\n}\r\n\r\nDominant.results<-apply(C8.genotip,2,qui.quadrado,cross=\"f2d\")\r\nCodominant.results<-apply(B3.genotip,2,qui.quadrado,cross=\"f2c\")\r\n\r\nDominant.results\r\n\r\nCodominant.results\r\n\r\n##correção bonferroni##\r\nbonferroni=0.05/418\r\nDominant.Bonferroni<-which(Dominant.results <= bonferroni)\r\nCodominant.Bonferroni<-which(Codominant.results<=bonferroni)\r\nDominant.Bonferroni\r\nCodominant.Bonferroni\r\n\r\n##numero de marcadores removidos\r\nlength(Dominant.Bonferroni)\r\nlength(Codominant.Bonferroni)\r\n\r\n##twopts=nome do objeto da classe rf.2pts com análise de dois pontos##\r\ntwopts <- rf.2pts(Dados_mimulus)\r\n\r\n##criação do arquivo de sequencias dos dados da análise de dois pontos##\r\nall.mrk<-make.seq(twopts, \"all\")\r\n\r\n##para designar grupos de ligação para marcadores##\r\nrcombination <- (0.5)*(((2.718^(4*(37/100)))-1)/((2.718^(4*(37/100)))+1))\r\nlgs<-group(all.mrk, LOD=6, max.rf=rcombination)\r\n\r\n##Para o grupo 1##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG1A <- make.seq(lgs,1)\r\nTESTE1 <- drop.marker(LG1A, Dominant.Bonferroni)\r\nLG1 <- drop.marker(TESTE1, Codominant.Bonferroni)\r\nLG1.rcd.f2 <- record(LG1)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG1.ord <- order.seq(LG1, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG1.final<-make.seq(LG1.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG1.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G1 <-rf.graph.table (LG1.final)\r\n\r\nLG1_final_map <- draw.map(LG1.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG1.final, \"mapa_onemap_G1.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G1.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 2##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG2A <- make.seq(lgs,2)\r\nTESTE2 <- drop.marker(LG2A, Dominant.Bonferroni)\r\nLG2 <- drop.marker(TESTE2, Codominant.Bonferroni)\r\nLG2.rcd.f2 <- record(LG2)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG2.ord <- order.seq(LG2, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG2.final<-make.seq(LG2.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG2.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G2 <-rf.graph.table (LG2.final)\r\n\r\nLG2_final_map <- draw.map(LG2.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG2.final, \"mapa_onemap_G2.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G2.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 3##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG3A <- make.seq(lgs,3)\r\nTESTE3 <- drop.marker(LG3A, Dominant.Bonferroni)\r\nLG3 <- drop.marker(TESTE3, Codominant.Bonferroni)\r\nLG3.rcd.f2 <- record(LG3)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG3.ord <- order.seq(LG3, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG3.final<-make.seq(LG3.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG3.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G3 <-rf.graph.table (LG3.final)\r\n\r\nLG3_final_map <- draw.map(LG3.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG3.final, \"mapa_onemap_G3.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G3.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##dividindo o grupo 3 novamente##\r\nrcombination <- (0.5)*(((2.718^(4*(25/100)))-1)/((2.718^(4*(25/100)))+1))\r\nlgs1teste<-group(LG3, LOD=7, max.rf=rcombination)\r\nlgs1teste\r\n\r\nrcombination\r\n##PARA o GRUPO 3a###\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nlg3a <- make.seq(lgs1teste,1)\r\nteste3a <- drop.marker(lg3a, Dominant.Bonferroni)\r\nlg3a <- drop.marker(teste3a, Codominant.Bonferroni)\r\nlg3a.rcd.f2 <- record(lg3a)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nlg3a.ord <- order.seq(lg3a, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(lg3a.final<-make.seq(lg3a.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(lg3a.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G3a <-rf.graph.table (lg3a.final)\r\n\r\nlg3a_final_map <- draw.map(lg3a.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(lg3a.final, \"mapa_onemap_g3a.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_g3a.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##PARA o GRUPO 3b###\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nlg3b <- make.seq(lgs1teste,2)\r\nteste3b <- drop.marker(lg3b, Dominant.Bonferroni)\r\nlg3b <- drop.marker(teste3b, Codominant.Bonferroni)\r\nlg3b.rcd.f2 <- record(lg3b)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nlg3b.ord <- order.seq(lg3b, n.init=5, subset.search=c(\"twopt\"),\r\n                      subset.n.try=30, subset.THRES=4,\r\n                      twopt.alg=c(\"rec\"), \r\n                      THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                      wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(lg3b.final<-make.seq(lg3b.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(lg3b.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G3b <-rf.graph.table (lg3b.final)\r\n\r\nlg3b_final_map <- draw.map(lg3b.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(lg3b.final, \"mapa_onemap_g3b.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_g3b.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##PARA o GRUPO 3c###\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nlg3c <- make.seq(lgs1teste,3)\r\nteste3c <- drop.marker(lg3c, Dominant.Bonferroni)\r\nlg3c <- drop.marker(teste3c, Codominant.Bonferroni)\r\nlg3c.rcd.f2 <- record(lg3c)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nlg3c.ord <- order.seq(lg3c, n.init=5, subset.search=c(\"twopt\"),\r\n                      subset.n.try=30, subset.THRES=4,\r\n                      twopt.alg=c(\"rec\"), \r\n                      THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                      wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(lg3c.final<-make.seq(lg3c.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(lg3c.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G3c <-rf.graph.table (lg3c.final)\r\n\r\nlg3c_final_map <- draw.map(lg3c.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(lg3c.final, \"mapa_onemap_g3c.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_g3c.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n\r\n##Para o grupo 4##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG4A <- make.seq(lgs,4)\r\nTESTE4 <- drop.marker(LG4A, Dominant.Bonferroni)\r\nLG4 <- drop.marker(TESTE4, Codominant.Bonferroni)\r\nLG4.rcd.f2 <- record(LG4)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG4.ord <- order.seq(LG4, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG4.final<-make.seq(LG4.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG4.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G4 <-rf.graph.table (LG4.final)\r\n\r\nLG4_final_map <- draw.map(LG4.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG4.final, \"mapa_onemap_G4.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G4.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 5##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG5A <- make.seq(lgs,5)\r\nTESTE5 <- drop.marker(LG5A, Dominant.Bonferroni)\r\nLG5 <- drop.marker(TESTE5, Codominant.Bonferroni)\r\nLG5.rcd.f2 <- record(LG5)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG5.ord <- order.seq(LG5, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG5.final<-make.seq(LG5.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG5.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G5 <-rf.graph.table (LG5.final)\r\n\r\nLG5_final_map <- draw.map(LG5.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG5.final, \"mapa_onemap_G5.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G5.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 6##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG6A <- make.seq(lgs,6)\r\nTESTE6 <- drop.marker(LG6A, Dominant.Bonferroni)\r\nLG6 <- drop.marker(TESTE6, Codominant.Bonferroni)\r\nLG6.rcd.f2 <- record(LG6)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG6.ord <- order.seq(LG6, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG6.final<-make.seq(LG6.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG6.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G6 <-rf.graph.table (LG6.final)\r\n\r\nLG6_final_map <- draw.map(LG6.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG6.final, \"mapa_onemap_G6.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G6.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n\r\n##Para o grupo 7##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG7A <- make.seq(lgs,7)\r\nTESTE7 <- drop.marker(LG7A, Dominant.Bonferroni)\r\nLG7 <- drop.marker(TESTE7, Codominant.Bonferroni)\r\nLG7.rcd.f2 <- record(LG7)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG7.ord <- order.seq(LG7, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG7.final<-make.seq(LG7.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG7.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G7 <-rf.graph.table (LG7.final)\r\n\r\nLG7_final_map <- draw.map(LG7.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG7.final, \"mapa_onemap_G7.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G7.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 8##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG8A <- make.seq(lgs,8)\r\nTESTE8 <- drop.marker(LG8A, Dominant.Bonferroni)\r\nLG8 <- drop.marker(TESTE8, Codominant.Bonferroni)\r\nLG8.rcd.f2 <- record(LG8)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG8.ord <- order.seq(LG8, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG8.final<-make.seq(LG8.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG8.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G8 <-rf.graph.table (LG8.final)\r\n\r\nLG8_final_map <- draw.map(LG8.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG8.final, \"mapa_onemap_G8.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G8.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n\r\n##Para o grupo 9##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG9A <- make.seq(lgs,9)\r\nTESTE9 <- drop.marker(LG9A, Dominant.Bonferroni)\r\nLG9 <- drop.marker(TESTE9, Codominant.Bonferroni)\r\nLG9.rcd.f2 <- record(LG9)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG9.ord <- order.seq(LG9, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG9.final<-make.seq(LG9.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG9.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G9 <-rf.graph.table (LG9.final)\r\n\r\nLG9_final_map <- draw.map(LG9.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG9.final, \"mapa_onemap_G9.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G9.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 10##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG10A <- make.seq(lgs,10)\r\nTESTE10 <- drop.marker(LG10A, Dominant.Bonferroni)\r\nLG10 <- drop.marker(TESTE10, Codominant.Bonferroni)\r\nLG10.rcd.f2 <- record(LG10)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG10.ord <- order.seq(LG10, n.init=5, subset.search=c(\"twopt\"),\r\n                     subset.n.try=30, subset.THRES=4,\r\n                     twopt.alg=c(\"rec\"), \r\n                     THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                     wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG10.final<-make.seq(LG10.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG10.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G10 <-rf.graph.table (LG10.final)\r\n\r\nLG10_final_map <- draw.map(LG10.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG10.final, \"mapa_onemap_G10.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G10.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 11##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG11A <- make.seq(lgs,11)\r\nTESTE11 <- drop.marker(LG11A, Dominant.Bonferroni)\r\nLG11 <- drop.marker(TESTE11, Codominant.Bonferroni)\r\nLG11.rcd.f2 <- record(LG11)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG11.ord <- order.seq(LG11, n.init=5, subset.search=c(\"twopt\"),\r\n                      subset.n.try=30, subset.THRES=4,\r\n                      twopt.alg=c(\"rec\"), \r\n                      THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                      wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG11.final<-make.seq(LG11.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG11.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G11 <-rf.graph.table (LG11.final)\r\n\r\nLG11_final_map <- draw.map(LG11.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG11.final, \"mapa_onemap_G11.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G11.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##Para o grupo 12##\r\n##arquivo das sequências##\r\nset.map.fun(type=\"kosambi\")\r\nLG12A <- make.seq(lgs,12)\r\nTESTE12 <- drop.marker(LG12A, Dominant.Bonferroni)\r\nLG12 <- drop.marker(TESTE12, Codominant.Bonferroni)\r\nLG12.rcd.f2 <- record(LG12)\r\n\r\n##para automatizar o processo de mapeamento de uma sequência de marcadores, combinando comparar e funções try.seq##\r\nLG12.ord <- order.seq(LG12, n.init=5, subset.search=c(\"twopt\"),\r\n                      subset.n.try=30, subset.THRES=4,\r\n                      twopt.alg=c(\"rec\"), \r\n                      THRES=4, touchdown=TRUE, draw.try=FALSE,\r\n                      wait=1, tol=10E-2) ##o uso das opções de try, thres etc. proporcinou um maior aproveitamento de marcadores##\r\n(LG12.final<-make.seq(LG12.ord, \"force\"))\r\n\r\n##Compara e exibe ordens alternativas plausíveis para uma determinada combinação##\r\nripple.seq(LG12.final,ws=4,LOD=3,tol=10E-2)\r\ngraph_G12 <-rf.graph.table (LG12.final)\r\n\r\nLG12_final_map <- draw.map(LG12.final, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(LG12.final, \"mapa_onemap_G12.map\")\r\n\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat1 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_G12.map\")\r\nnewmap <- est.map(dat1, tol=1e-6, map.function=\"kosambi\")\r\n\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##unir os 6 primeiros grupos-1,2,3a,3b,3c,4##\r\nmaps.list.1.6 <- list(LG1.final, LG2.final, lg3a.final, lg3b.final, lg3c.final, LG4.final)\r\nmapa.1.6 <- draw.map(maps.list.1.6, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(maps.list.1.6, \"mapa_onemap_1_6.map\")\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat2 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_1_6.map\")\r\nnewmap <- est.map(dat2, tol=1e-6, map.function=\"kosambi\")\r\nplotMap(newmap, show.marker.names=TRUE, verbose=TRUE, ylab=\"Distance (cM)\", xlab=\"group\")\r\n\r\n##unir os 6 segundos grupos-5,6,7,8,9,10##\r\nmaps.list.5.10 <- list(LG5.final, LG6.final, LG7.final, LG8.final, LG9.final, LG10.final)\r\nmapa.5.10 <- draw.map(maps.list.5.10, names= TRUE, grid=TRUE, cex.mrk=0.6)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\nwrite.map(maps.list.5.10, \"mapa_onemap_5_10.map\")\r\nrequire(qtl)\r\nsetwd (\"E:/ESALQ/PÓS GRADUAÇÃO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/aula6\")\r\ndat3 <- read.cross(\"mm\", file=\"m_feb06.raw\", mapfile=\"mapa_onemap_5_10.map\")\r\nnewmap <- est.map(dat3, tol=1e-6, map.function=\"kosambi\")\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}